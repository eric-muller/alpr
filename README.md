The overall idea is to facilitate the processing of Flock logs. The data
is loaded in a Postgresql database, and a bunch of queries are made.
The results of those queries are injected in a template .html file.

===

You will need the following tools: bash, gnumeric, postgresql,
gawk, java, saxon.

Instead of bash, probably any other shell with work fine. But of course,
I never tried another shell.

gnumeric gives us ssconvert, which we use to convert data provided
in .xlsx into .cvs, before importing it in postgresql.

We need a version of awk that can handle csv files. gawk does.

Java and saxon are only to generate the .html reports.

I also used ssconvert from the gnumeric package to convert .xslx to .csv, but
this has been done manually so far.

===

Each agency for which we collect and process data has its directory
under /data. Inside of that, the pattern is:

00_common.sh
  a few parameters for the agency

03_load_queries.sh
  to load the organization and network audit data

06_load_sharing.sh
  to load the sharing audit data

data-*
  a directory to hold the audit data in .csv form; typically one directory
  per Public Record Request, with "*" identifying the request.

data-*/original
  if the audit data needs some processing before we can use it,
  then these are the original files

reports/
  files generated by running the scripts

summary.html
  a template for the whole report. In addition to the plain HTML content,
  there can be <insert f='file.html'> elements, that will be replaced
  by the content of the file.html, to be found in the reports/ directory.

Take a look at the existing agencies to see the details.

===

To process an agency:

$ cd data/<agency>
$ sh ../../scripts/98_full.sh

This will load the data in postgres, and make a whole bunch of queries, with
their results in data/<agency>/reports. There are typically three results
per query, one to get a list in text form (.txt), one to get the same list in
html form (.html), for inclusion in the html report, and one to the number
of items in the list (.count).

===
